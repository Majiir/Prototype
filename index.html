<html>
	<head>
		<title>Prototype Game Section</title>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	  	<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
	  	<script>
	  	$(function() {
			for (var i = 0; i < 6; i++) {
				var pipe = makePipe();
			}

			function makePipe () {
				var id = Math.floor(Math.random()*7);
				var pipe = $('<div class="pipe"></div>')
					.draggable({ revert: 'invalid' })
					.attr('data-pipeType', id)
					.text(id);

				if([0,2,3,6].indexOf(id) > -1) {
					pipe.css({ 'border-top-color': 'blue' });
				}
				if([0,1,3,4].indexOf(id) > -1) {
					pipe.css({ 'border-right-color': 'blue' });
				}
				if([0,2,4,5].indexOf(id) > -1) {
					pipe.css({ 'border-bottom-color': 'blue' });
				}
				if([0,1,5,6].indexOf(id) > -1) {
					pipe.css({ 'border-left-color': 'blue' });
				}

				$('#queue').prepend(pipe);
				return pipe;
			}

			function getRight (pipe) {
				return pipe.next('.pipe');
			};

			function getLeft (pipe) {
				return pipe.prev('.pipe');
			};

			function getTop (pipe) {
				return pipe.parent().prev().children().eq(pipe.index()).filter('.pipe');
			};

			function getBottom (pipe) {
				return pipe.parent().next().children().eq(pipe.index()).filter('.pipe');
			};			

	  		$('.slot').droppable({
				drop: function( event, ui ) {
					var index = $(this).index();
					$('#board .row').each(function() { $(this).children().eq(index).removeClass('over'); });
					$(this).siblings().each(function() { $(this).removeClass('over'); });

					var pipe = ui.draggable;
					$(this).replaceWith(pipe);
					pipe.draggable('destroy');
					pipe.css({ 'position': '', 'left': '', 'top': '' });

					pipe = makePipe();
					pipe.hide().slideDown();
				},
				over: function( event, ui ) {
					var index = $(this).index();
					$('#board .row').each(function() { $(this).children().eq(index).addClass('over'); });
					$(this).siblings().each(function() { $(this).addClass('over'); });
				},
				out: function( event, ui ) {
					var index = $(this).index();
					$('#board .row').each(function() { $(this).children().eq(index).removeClass('over'); });
					$(this).siblings().each(function() { $(this).removeClass('over'); });
				}
			});
	  	});
	  	</script>
		<style>
			#queue {
				float: left;
				height: 520px;
				width: 95px;
				background-color: #8c8;
			}

			#board {
				float: left;
				height: 520px;
				width: 775px;
				background-color: #caa;
			}

			.grid .row {
				clear: left;
			}

			.grid .row .pipe,
			.grid .row .slot {
				float: left;
			}

			.pipe, .slot {
				height: 55px;
				width: 55px;
				margin-left: 10px;
				margin-top: 10px;
				border: 10px solid transparent;
			}

			.pipe {
				background-color: #aea;
			}

			.slot {
				background-color: #faa;
			}

			.slot.filled {
				background-color: #ccc;
			}

			.slot.over {
				background-color: #fcc;
			}
		</style>
	</head>
	<body>
		<div id="queue">
		</div>
		<div id="board">
			<div class="grid">
				<div class="row">
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
				</div>
				<div class="row">
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
				</div>
				<div class="row">
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
				</div>
				<div class="row">
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
				</div>
				<div class="row">
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
				</div>
				<div class="row">
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
					<div class="slot"></div>
				</div>
			</div>
		</div>
	</body>
</html>